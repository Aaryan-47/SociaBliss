(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{49748:function(e,t,n){"use strict";n.d(t,{g0:function(){return s}});var r=n(67294),o=n(61409),a=r.createElement,s=function(){return a(o.Ix,{position:"bottom-center",autoClose:3e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!1},o.Am.info("Deleted Successfully",{position:"bottom-center",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!1,draggable:!0,progress:void 0}))}},20705:function(e,t,n){"use strict";n.d(t,{Z:function(){return O}});var r=n(80018),o=n(67294),a=n(345),s=n(35766),i=n(73626),u=n(76763),c=n(92990),l=n(39445),p=n(48237),d=n(65382),f=n(60345),m=n(86778),g=n(60139),h=n(41715),Z=n(41664),v=n(67037),b=n(21309),k=n(14309),w=o.createElement;var y=function(e){var t=e.post,n=e.user,r=e.setLikes,s=e.likes,c=e.isLiked,l=e.comments,p=e.setComments;return w(o.Fragment,null,w(k.Z,{columns:2,stackable:!0,relaxed:!0},w(k.Z.Column,null,w(a.Z.Content,{image:!0},w(u.Z,{wrapped:!0,size:"large",src:t.picUrl}))),w(k.Z.Column,null,w(i.Z,{fluid:!0},w(i.Z.Content,null,w(u.Z,{floated:"left",avatar:!0,src:t.user.profilePicUrl}),w(i.Z.Header,null,w(Z.default,{href:"/".concat(t.user.username)},w("a",null,t.user.name))),w(i.Z.Meta,null,(0,h.Z)(t.createdAt)),t.location&&w(i.Z.Meta,{content:t.location}),w(i.Z.Description,{style:{fontSize:"17px",letterSpacing:"0.1px",wordSpacing:"0.35px"}},t.text)),w(i.Z.Content,{extra:!0},w(d.Z,{name:c?"heart":"heart outline",color:"red",style:{cursor:"pointer"},onClick:function(){return(0,v.n9)(t._id,n._id,r,!c)}}),w(b.Z,{postId:t._id,trigger:s.length>0&&w("span",{className:"spanLikesList"},"".concat(s.length," ").concat(1===s.length?"like":"likes"))}),w(f.Z,{hidden:!0}),w("div",{style:{overflow:"auto",height:l.length>2?"200px":"60px",marginBottom:"8px"}},l.length>0&&l.map((function(e){return w(m.Z,{key:e._id,comment:e,postId:t._id,user:n,setComments:p})}))),w(g.Z,{postId:t._id,user:n,setComments:p}))))))},P=o.createElement;var x=function(e){var t=e.post,n=e.user,r=e.setLikes,o=e.likes,a=e.isLiked,s=e.comments,c=e.setComments;return P(i.Z,{fluid:!0},P(i.Z.Content,null,P(u.Z,{floated:"left",avatar:!0,src:t.user.profilePicUrl}),P(i.Z.Header,null,P(Z.default,{href:"/".concat(t.user.username)},P("a",null,t.user.name))),P(i.Z.Meta,null,(0,h.Z)(t.createdAt)),t.location&&P(i.Z.Meta,{content:t.location}),P(i.Z.Description,{style:{fontSize:"17px",letterSpacing:"0.1px",wordSpacing:"0.35px"}},t.text)),P(i.Z.Content,{extra:!0},P(d.Z,{name:a?"heart":"heart outline",color:"red",style:{cursor:"pointer"},onClick:function(){return(0,v.n9)(t._id,n._id,r,!a)}}),P(b.Z,{postId:t._id,trigger:o.length>0&&P("span",{className:"spanLikesList"},"".concat(o.length," ").concat(1===o.length?"like":"likes"))}),P(f.Z,{hidden:!0}),P("div",{style:{overflow:"auto",height:s.length>2?"200px":"60px",marginBottom:"8px"}},s.length>0&&s.map((function(e){return P(m.Z,{key:e._id,comment:e,postId:t._id,user:n,setComments:c})}))),P(g.Z,{postId:t._id,user:n,setComments:c})))},C=o.createElement;var O=function(e){var t=e.post,n=e.user,k=e.setPosts,w=e.setShowToastr,P=e.socket,O=(0,o.useState)(t.likes),S=O[0],_=O[1],I=S.length>0&&S.filter((function(e){return e.user===n._id})).length>0,D=(0,o.useState)(t.comments),M=D[0],N=D[1],j=(0,o.useState)(null),L=(j[0],j[1],(0,o.useState)(!1)),E=L[0],U=L[1],A=function(){return{post:t,user:n,setLikes:_,likes:S,isLiked:I,comments:M,setComments:N}};return C(o.Fragment,null,E&&C(a.Z,{open:E,closeIcon:!0,closeOnDimmerClick:!0,onClose:function(){return U(!1)}},C(a.Z.Content,null,t.picUrl?C(y,A()):C(x,A()))),C(s.Z,{basic:!0},C(i.Z,{color:"teal",fluid:!0},t.picUrl&&C(u.Z,{src:t.picUrl,style:{cursor:"pointer"},floated:"left",wrapped:!0,ui:!1,alt:"PostImage",onClick:function(){return U(!0)}}),C(i.Z.Content,null,C(u.Z,{floated:"left",src:t.user.profilePicUrl,avatar:!0,circular:!0}),("root"===n.role||t.user._id===n._id)&&C(o.Fragment,null,C(c.Z,{on:"click",position:"top right",trigger:C(u.Z,{src:"/deleteIcon.svg",style:{cursor:"pointer"},size:"mini",floated:"right"})},C(l.Z,{as:"h4",content:"Are you sure?"}),C("p",null,"This action is irreversible!"),C(p.Z,{color:"red",icon:"trash",content:"Delete",onClick:function(){return(0,v.fR)(t._id,k,w)}}))),C(i.Z.Header,null,C(Z.default,{href:"/".concat(t.user.username)},C("a",null,t.user.name))),C(i.Z.Meta,null,(0,h.Z)(t.createdAt)),t.location&&C(i.Z.Meta,{content:t.location}),C(i.Z.Description,{style:{fontSize:"17px",letterSpacing:"0.1px",wordSpacing:"0.35px"}},t.text)),C(i.Z.Content,{extra:!0},C(d.Z,{name:I?"heart":"heart outline",color:"red",style:{cursor:"pointer"},onClick:function(){P.current?(P.current.emit("likePost",{postId:t._id,userId:n._id,like:!I}),P.current.on("PostLiked",(function(){_(I?function(e){return e.filter((function(e){return e.user!==n._id}))}:function(e){return[].concat((0,r.Z)(e),[{user:n._id}])})}))):(0,v.n9)(t._id,n._id,_,!I)}}),C(b.Z,{postId:t._id,trigger:S.length>0&&C("span",{className:"spanLikesList"},"".concat(S.length," ").concat(1===S.length?"like":"likes"))}),C(d.Z,{name:"comment outline",style:{marginLeft:"7px"},color:"blue"}),M.length>0&&M.map((function(e,r){return r<3&&C(m.Z,{key:e._id,comment:e,postId:t._id,user:n,setComments:N})})),M.length>3&&C(p.Z,{content:"View More",color:"teal",basic:!0,circular:!0,onClick:function(){return U(!0)}}),C(f.Z,{hidden:!0}),C(g.Z,{user:n,postId:t._id,setComments:N})))),C(f.Z,{hidden:!0}))}},89087:function(e,t,n){"use strict";n.d(t,{t:function(){return i}});var r=n(15503),o=n(19),a=n(90774),s=(0,r.ZF)({apiKey:"AIzaSyD6TPPzuK9nu0UYX3HzZyVHCm67OyNQ9Ao",authDomain:"hackathon-e769d.firebaseapp.com",projectId:"hackathon-e769d",storageBucket:"hackathon-e769d.appspot.com",messagingSenderId:"563468467684",appId:"1:563468467684:web:920a6df0a19b069ad25bf1",measurementId:"G-2MFPBL0N0Z"}),i=((0,o.ad)(s),(0,a.cF)(s))},22252:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return ne}});var r=n(80018),o=n(87757),a=n.n(o),s=n(96156),i=n(92137),u=n(67294),c=n(86809),l=n.n(c),p=n(9669),d=n.n(p),f=n(94953),m=n.n(f),g=n(19909),h=n(68788),Z=n(76763),v=n(65382),b=n(60345),k=n(48237),w=n(33404),y=n(44586),P=n(89087),x=n(67037),C=u.createElement;function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _=function(e){var t=e.user,n=e.setPosts,r=(0,u.useState)({text:"",location:""}),o=r[0],c=r[1],l=(0,u.useState)(!1),p=l[0],d=l[1],f=(0,u.useRef)(),m=(0,u.useState)(null),O=m[0],_=m[1],I=(0,u.useState)(!1),D=I[0],M=I[1],N=(0,u.useState)(null),j=N[0],L=N[1],E=(0,u.useState)(null),U=E[0],A=E[1],z=(0,u.useState)(""),F=z[0],T=(z[1],function(e){var t=e.target,n=t.name,r=t.value,o=t.files;"media"===n&&(L(o[0]),A(URL.createObjectURL(o[0]))),c((function(e){return S(S({},e),{},(0,s.Z)({},n,r))}))}),R=function(){var e=(0,i.Z)(a().mark((function e(t){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),d(!0),null===j){e.next=7;break}r=(0,w.iH)(P.t,"/images/".concat(j.name+(0,y.Z)())),(0,w.KV)(r,j).then((function(){(0,w.Jt)(r).then(function(){var e=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,x.hD)(o.text,o.location,t,n,c,_);case 2:console.log(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log(e)}))})),e.next=9;break;case 7:return e.next=9,(0,x.hD)(o.text,o.location,F,n,c,_);case 9:L(null),A(null),d(!1);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return C(u.Fragment,null,C(g.Z,{error:null!==O,onSubmit:R},C(h.Z,{error:!0,onDismiss:function(){return _(null)},content:O,header:"Oops!"}),C(g.Z.Group,null,C(Z.Z,{src:t.profilePicUrl,circular:!0,avatar:!0,inline:!0}),C(g.Z.TextArea,{placeholder:"Whats Happening",name:"text",value:o.text,onChange:T,rows:4,width:14})),C(g.Z.Group,null,C(g.Z.Input,{value:o.location,name:"location",onChange:T,label:"Add Location",icon:"map marker alternate",placeholder:"Want to add Location?"}),C("input",{ref:f,onChange:T,name:"media",style:{display:"none"},type:"file",accept:"image/*"})),C("div",{onClick:function(){return f.current.click()},style:{textAlign:"center",height:"150px",width:"150px",border:"dotted",paddingTop:null===j&&"60px",cursor:"pointer",borderColor:D?"green":"black"},onDrag:function(e){e.preventDefault(),M(!0)},onDragLeave:function(e){e.preventDefault(),M(!1)},onDrop:function(e){e.preventDefault(),M(!0);var t=Array.from(e.dataTransfer.files);L(t[0]),A(URL.createObjectURL(t[0]))}},null===j?C(v.Z,{name:"plus",size:"big"}):C(u.Fragment,null,C(Z.Z,{style:{height:"150px",width:"150px"},src:U,alt:"PostImage",centered:!0,size:"medium"}))),C(b.Z,{hidden:!0}),C(k.Z,{circular:!0,disabled:""===o.text||p,content:C("strong",null,"Post"),style:{backgroundColor:"#1DA1F2",color:"white"},icon:"send",loading:p})),C(b.Z,null))},I=n(20705),D=n(35766),M=n(62286),N=n(26048),j=n(49748),L=n(58533),E=n(30899),U=n(36808),A=n.n(U),z=n(27354),F=n(345),T=n(59574),R=n(41664),H=n(41715),B=u.createElement;var V=function(e){var t=e.username;return B(T.Z,null,B(T.Z.Item,null,B(v.Z,{name:"help"}),B(T.Z.Content,null,B(T.Z.Header,null,"If you do not like this popup to appear when you receive a new message:"))),B(T.Z.Item,null,B(v.Z,{name:"hand point right"}),B(T.Z.Content,null,"You can disable it by going to",B(R.default,{href:"/".concat(t)},B("a",null," Account ")),"Page and clicking on Settings Tab.")),B(T.Z.Item,null,B(v.Z,{name:"hand point right"}),"Inside the menu,there is an setting named: Show New Message Popup?"),B(T.Z.Item,null,B(v.Z,{name:"hand point right"}),"Just toggle the setting to disable/enable the Message Popup to appear."))},W=function(e){var t=e.socket,n=e.showNewMessageModal,r=e.newMessageModal,o=e.newMessageReceived,a=e.user,s=(0,u.useState)(""),i=s[0],c=s[1],l=(0,u.useState)(!1),p=l[0];return l[1],B(u.Fragment,null,B(F.Z,{size:"small",open:r,onClose:function(){return n(!1)},closeIcon:!0,closeOnDimmerClick:!0},B(F.Z.Header,{content:"New Message from ".concat(o.senderName)}),B(F.Z.Content,null,B("div",{className:"bubbleWrapper"},B("div",{className:"inlineContainer"},B("img",{className:"inlineIcon",src:o.senderProfilePic})),B("div",{className:"otherBubble other"},o.msg),B("span",{className:"other"},(0,H.Z)(o.date))),B("div",{style:{position:"sticky",bottom:"0px"}},B(D.Z,{secondary:!0,color:"teal",attached:"bottom"},B(g.Z,{reply:!0,onSubmit:function(e){e.preventDefault(),t.current&&(t.current.emit("sendMsgFromNotification",{userId:a._id,msgSendToUserId:o.sender,msg:i}),t.current.on("msgSentFromNotification",(function(){n(!1)})))}},B(g.Z.Input,{size:"large",placeholder:"Send New Message",value:i,onChange:function(e){return c(e.target.value)},action:{color:"blue",icon:"telegram plane",disabled:""===i,loading:p}})))),B("div",{style:{marginTop:"5px"}},B(R.default,{href:"/messages?message=".concat(o.sender)},B("a",null,"View All Messages")),B("br",null),B(V,{username:a.username})))))},G=n(51553),K=n(69445),X=n(41954),J=n(11163),Y=u.createElement;var Q=function(e){var t=e.newNotification,n=e.notificationPopup,r=(e.showPopup,(0,J.useRouter)()),o=t.name,a=t.profilePicUrl,s=t.username,i=t.postId;return Y(K.Z,{transition:{animation:"fade left",duration:"500"},onClose:function(){return n&&setPopup(!1)},onOpen:G.Z,open:n},Y(D.Z,{style:{right:"5%",position:"fixed",top:"10%",zIndex:1e3}},Y(v.Z,{name:"close",size:"large",style:{float:"right",cursor:"pointer"},onClick:function(){return setPopup(!1)}}),Y(X.Z,null,Y(X.Z.Event,null,Y(X.Z.Label,null,Y("img",{src:a})),Y(X.Z.Content,null,Y(X.Z.Summary,null,Y(X.Z.User,{onClick:r.push("/".concat(s))},o),"liked your ",Y("a",{onClick:r.push("/post/".concat(i))},"post"),Y(X.Z.Date,null,(0,H.Z)(Date.now()))))))))},q=u.createElement;function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function te(e){var t=e.user,n=e.postsData,o=e.errorLoading,s=(0,u.useState)(n||[]),c=s[0],p=s[1],f=(0,u.useState)(!1),g=f[0],h=f[1],Z=(0,u.useState)(!0),v=Z[0],b=Z[1],k=(0,u.useState)(2),w=k[0],y=k[1],P=(0,u.useRef)(),x=(0,u.useState)(null),C=x[0],O=x[1],S=(0,u.useState)(!1),M=S[0],U=S[1],F=(0,u.useState)(null),T=F[0],R=F[1],H=(0,u.useState)(!1),B=H[0],V=H[1];(0,u.useEffect)((function(){return P.current||(P.current=l()(m())),P.current&&(P.current.emit("join",{userId:t._id}),P.current.on("newMsgReceived",function(){var e=(0,i.Z)(a().mark((function e(n){var r,o,s,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.newMsg,e.next=3,(0,z.Z)(r.sender);case 3:o=e.sent,s=o.name,i=o.profilePicUrl,t.newMessagePopup&&(O(ee(ee({},r),{},{senderName:s,senderProfilePic:i})),U(!0)),(0,G.Z)(s);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),document.title="Welcome, ".concat(t.name.split(" ")[0]),function(){P.current&&(P.current.emit("disconnect"),P.current.off())}}),[]),(0,u.useEffect)((function(){g&&setTimeout((function(){return h(!1)}),3e3)}),[g]),(0,u.useEffect)((function(){P.current&&P.current.on("newNotificationRecieved",(function(e){var t=e.name,n=e.profilePicUrl,r=e.username,o=e.postId;R({name:t,profilePicUrl:n,username:r,postId:o}),V(!0)}))}),[]);var K=function(){var e=(0,i.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d().get("".concat(m(),"/api/posts"),{headers:{Authorization:A().get("token")},params:{pageNumber:w}});case 3:0===(t=e.sent).data.length&&b(!1),p((function(e){return[].concat((0,r.Z)(e),(0,r.Z)(t.data))})),y((function(e){return e+1})),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),alert("Error fetching Posts");case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();return 0===c.length||o?q(u.Fragment,null,q(_,{user:t,setPosts:p}),q(N.o0,null)):q(u.Fragment,null,B&&null!==T&&q(Q,{newNotification:T,notificationPopup:B,showPopup:V}),g&&q(j.g0,null),M&&null!==C&&q(W,{socket:P,showNewMessageModal:U,newMessageModal:M,newMessageReceived:C,user:t}),q(D.Z,null,q(_,{user:t,setPosts:p}),q(L.Z,{hasMore:v,next:K,loader:q(E.pj,null),endMessage:q(E.SC,null),dataLength:c.length},c.map((function(e){return q(I.Z,{socket:P,key:e._id,post:e,user:t,setPosts:p,setShowToastr:h})})))))}te.getInitialProps=function(){var e=(0,i.Z)(a().mark((function e(t){var n,r,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=(0,M.parseCookies)(t),r=n.token,e.next=4,d().get("".concat(m(),"/api/posts"),{headers:{Authorization:r},params:{pageNumber:1}});case 4:return o=e.sent,e.abrupt("return",{postsData:o.data});case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",{errorLoading:!0});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}();var ne=te},27354:function(e,t,n){"use strict";var r=n(87757),o=n.n(r),a=n(92137),s=n(9669),i=n.n(s),u=n(94953),c=n.n(u),l=n(36808),p=n.n(l),d=function(){var e=(0,a.Z)(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i().get("".concat(c(),"/api/chats/user/").concat(t),{headers:{Authorization:p().get("token")}});case 3:return n=e.sent,e.abrupt("return",{name:n.data.name,profilePicUrl:n.data.profilePicUrl});case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();t.Z=d},51553:function(e,t){"use strict";t.Z=function(e){var t=new Audio("/light.mp3");t&&t.play(),e&&(document.title="New message from ".concat(e),"visible"===document.visibilityState&&setTimeout((function(){document.title="Messages"}),5e3))}},78581:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(22252)}])},77020:function(){}},function(e){e.O(0,[885,662,16,654,134,389,911,420,809,922,554,9,774,888,179],(function(){return t=78581,e(e.s=t);var t}));var t=e.O();_N_E=t}]);